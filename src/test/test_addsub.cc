#include <stdio.h>
#include <stdlib.h>
#include <string>
#include <iostream>
#include <gtest/gtest.h>
#include <mympz/mympz.h>

using namespace mympz;

TEST(Mympz, Add) {
  bignum_t x,y,z;
  std::string z_str;

  x = create("123");
  y = create("456");
  z = add(x, y);
  z_str = print_string(z);
  EXPECT_STREQ(z_str.c_str(), "579");

  x = create(123578);
  y = create(456);
  z = add(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "124034");

  x = create("542312987594815423856747823648316483765817498347594387654298305473296754093285473267954278547852437985044378493174981327489321074893017431123578");
  y = create("542312987594815423856747823648316483765817498347594387654298305473296754");
  z = add(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "542312987594815423856747823648316483765817498347594387654298305473296754635598460862769702404600261633360862258992479675083708729191322904420332");

  x = create("457983178439069536858730917898542748542543432135748265824310978965742043718292075940274893217598104381274983217489321748903427158942374893102749032715948237493201749834750917483921074983217493174319180952");
  y = create("-542312987594815423856747823648316483765817498347594387654298305473296754635598460862769702404600261633360862258992479675083708729191322904420332");
  z = add(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "457983178439069536858730917898542748542543432135748265824310436652754448902868219192451244901114338563776635623101667450597953862187739294641886263013543637231568388972491925004245991274488301851414760620");

  x = create("-457983178439069536858730917898542748542543432135748265824310978965742043718292075940274893217598104381274983217489321748903427158942374893102749032715948237493201749834750917483921074983217493174319180952");
  y = create("542312987594815423856747823648316483765817498347594387654298305473296754635598460862769702404600261633360862258992479675083708729191322904420332");
  z = add(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "-457983178439069536858730917898542748542543432135748265824310436652754448902868219192451244901114338563776635623101667450597953862187739294641886263013543637231568388972491925004245991274488301851414760620");
}

TEST(Mympz, Sub) {
  bignum_t x,y,z;
  std::string z_str;

  x = create("123");
  y = create("456");
  z = sub(x, y);
  z_str = print_string(z);
  EXPECT_STREQ(z_str.c_str(), "-333");

  x = create(123578);
  y = create(456);
  z = sub(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "123122");

  x = create("98657492147839215426583976850943685034869538594254739257439473194731984731947810473189473981473982174329814739817438291473819247398124793748627593867981238504869537698582309759424893021857894325910283459468785941283905740928403217594180948321940549310483012840");
  y = create("9999999999999999999999999999999999999999999999999933333333333333333333333333333333333333333333333333333333333333333333333888888888888888888888888888888888888888888888888888888888888888881111111111111111111111111111111111111111111111111111111111177777777777777777777777777777777777777777777777777777555555555555555555555555555555555555555555");
  z = sub(x, y);
  z_str = print_string(z);
  EXPECT_TRUE(z_str == "-9999999999999999999999999999999999999999999999999933333333333333333333333333333234675841185494117906749356482389648298464350294634149631449415694156904156941078415699414907414906714559066371293672819637291863712986317362483517243129872606241573479195468018352884755919883451867494318308991836493871814627152337961374607233615006245072542715");
}

TEST(Mympz, AddUnit) {
  bignum_t x,y;
  std::string y_str;

  x = create("2133545241523432654321426543543143215425434312425312454254243154241425314315424314432");

  y = add(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "2133545241523432654321426543543143215425434312425312454254243154253747087909491009412");

  zero(x);
  y = add(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "12321773594066694980");

  x = create("-2133545241523432654321426543543143215425434312425312454254243154241425314315424314432");
  y = add(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "-2133545241523432654321426543543143215425434312425312454254243154229103540721357619452");
}

TEST(Mympz, SubUnit) {
  bignum_t x,y;
  std::string y_str;

  x = create("AAFFBBCCDD22334411", true);
  y = sub(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "3142052266487007219917");

  zero(x);
  y = sub(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "-12321773594066694980");

  x = create("2133545241523432654321426543543143215425434312425312454254243154241425314315424314432");
  y = sub(x, 0xAAFFBBCCDD223344);
  y_str = print_string(y);
  EXPECT_STREQ(y_str.c_str(), "2133545241523432654321426543543143215425434312425312454254243154229103540721357619452");
}

int main(int argc, char* argv[]) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}